<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Rock That Body - Lyric</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg-black:#000;
      --bg-white:#fff;
      --text-white:#fff;
      --text-black:#000;
    }

    html,body{
      height:100%;
      margin:0;
      background:var(--bg-black);
      color:var(--text-white);
      font-family: 'Press Start 2P', monospace;
    }

    /* Center full screen */
    .stage{
      height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
    }

    /* The single line word element (always one line) */
    #word {
      font-size: 35px;            /* chỉnh lớn nhỏ ở đây */
      line-height: 1;
      text-align:center;
      white-space: nowrap;        /* buộc trên 1 hàng */
      padding: 10px 20px;
      transition: color 0.18s linear, transform 0.12s linear;
      will-change: transform, opacity;
      -webkit-font-smoothing: none;
    }

    /* nhẹ pop / nẩy */
    .pop {
      transform: scale(1.18);
      transition: transform 0.28s cubic-bezier(.2,.8,.25,1);
    }

    /* fade in subtle */
    .fade {
      opacity: 0;
      animation: fadeIn .22s forwards;
    }
    @keyframes fadeIn {
      to { opacity: 1; }
    }
  </style>
</head>
<body>
  <div class="stage">
    <div id="word"> </div>
  </div>

  <script>
    // ===== lyrics chunk (giữ đúng nội dung bạn yêu cầu) =====
    const lyricsBlock = [
      "I","wanna","da,","I","wanna","dance","in","the","lights",
      "I","wanna","ro-,","I","wanna","rock","your","body",
      "I","wanna","go,","I","wanna","go","for","a","ride",
      "Hop","in","the","music","and","rock","your","body","right",
      "Rock","that","body,","come","on,","come","on,","rock","that","body",
      "Let","me","see","your","body","rock"
    ];

    // optional: nhân bản để có nhiều từ chạy (bạn có thể giảm nếu muốn ngắn)
    let words = [];
    for (let r=0; r<18; r++){ words = words.concat(lyricsBlock); }

    const el = document.getElementById('word');

    // thời gian (ms) - bạn dễ chỉnh để phù hợp nhịp
    const MAIN_MS = 350;     // tempo chữ bình thường
    const ACC_STEP_MS = 300; // tốc độ từng bước của "rock"->"rock your"->"rock your body"
    const ACC_PAUSE_MS = 300; // pause nhỏ sau khúc tích lũy

    let idx = 0;
    let intervalId = null;
    let specialDone = false; // chỉ chạy khúc tích lũy 1 lần

    // helper hiển thị text với pop + fade
    function showText(text){
      el.classList.remove('pop','fade');
      // restart transition
      void el.offsetWidth;
      el.textContent = text;
      el.classList.add('fade','pop');
      // remove pop after short time so next pop re-triggers
      setTimeout(()=> el.classList.remove('pop'), 280);
    }

    function normalize(s){
      return String(s).replace(/[^\w]/g,'').toLowerCase();
    }

    // chức năng hiển thị tích lũy trên một hàng (không chồng)
    function accumulatedLine(parts, step = 1, doneCallback){
      if (step <= parts.length){
        const text = parts.slice(0, step).join(' ');
        showText(text);
        setTimeout(()=> accumulatedLine(parts, step + 1, doneCallback), ACC_STEP_MS);
      } else {
        // xong 3 bước
        setTimeout(()=> { if(doneCallback) doneCallback(); }, ACC_PAUSE_MS);
      }
    }

    function tick(){
      // bảo đảm words còn phần tử
      if (!words.length) return;

      const w = words[idx];

      // detect special sequence "rock your body" (lần đầu xuất hiện)
      if (!specialDone
          && normalize(w) === 'rock'
          && normalize(words[(idx+1) % words.length]) === 'your'
          && normalize(words[(idx+2) % words.length]) === 'body') {

        specialDone = true;
        clearInterval(intervalId); // pause main loop

        // chạy tích lũy trên 1 hàng
        accumulatedLine(['rock','your','body'], 1, ()=> {
          // sau khi xong, nhảy qua 3 từ đó
          idx = (idx + 3) % words.length;
          // resume loop
          intervalId = setInterval(tick, MAIN_MS);
        });

        return;
      }

      // normal display
      showText(w);

      // invert background when word is lights
      if (normalize(w) === 'lights'){
        document.body.style.background = 'white';
        el.style.color = 'black';
      } else {
        document.body.style.background = 'black';
        el.style.color = 'white';
      }

      idx = (idx + 1) % words.length;
    }

    // start immediately and set interval
    tick();
    intervalId = setInterval(tick, MAIN_MS);

    // optional: pause/resume on click
    let running = true;
    document.body.addEventListener('click', ()=>{
      if (running){
        clearInterval(intervalId);
        running = false;
      } else {
        intervalId = setInterval(tick, MAIN_MS);
        running = true;
      }
    });
  </script>
</body>
</html>
